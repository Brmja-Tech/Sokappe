# ุฏููู ุญู ูุดููุฉ FCM Token

## ุงููุดููุฉ

ูุงู ูุชู ุฅุฑุณุงู FCM token ุจูููุฉ ุซุงุจุชุฉ "34434" ุจุฏูุงู ูู token ุญูููู ูู Firebase.

## ุงูุญู ุงููุทุจู

### 1. ุชุญุณูู ููู Firebase Messaging

ุชู ุชุญุณูู `src/config/firebase-messaging.js` ูุฅุถุงูุฉ:

- Debugging ููุตู ููุนุฑูุฉ ุณุจุจ ุนุฏู ุงูุญุตูู ุนูู token
- ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
- ุฑุณุงุฆู ูุงุถุญุฉ ูู console
- **ุงูุณูุงุญ ุจู HTTP ูู ุจูุฆุฉ ุงูุชุทููุฑ ููุท**

### 2. ุชุญุณูู ุตูุญุฉ Login

ุชู ุชุนุฏูู `src/pages/Login/Login.jsx` ูุฅุถุงูุฉ:

- ุงูุญุตูู ุนูู FCM token ุฏููุงูููู
- ุญูุธ token ูู localStorage ููุงุณุชุฎุฏุงู ูุงุญูุงู
- ุฒุฑ ุงุฎุชุจุงุฑ FCM token
- ูุนุงูุฌุฉ ุฃูุถู ููุญุงูุงุช ุงููุฎุชููุฉ
- **ุชูููุฏ FCM token ูุคูุช ูู ุญุงูุฉ ุงููุดู**
- **ูุดู ููุน ุงููุชุตูุญ ููุนุงูุฌุชู ุจุดูู ุฎุงุต**

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุงุฎุชุจุงุฑ FCM Token

- ุงุถุบุท ุนูู ุฒุฑ "๐งช ุงุฎุชุจุงุฑ FCM Token" ูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
- ุชุญูู ูู console ูุฑุคูุฉ ุงูุชูุงุตูู
- ุณุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ ุฃู ูุดู ูุน ูุนูููุงุช ุงููุชุตูุญ

### 2. ุชุณุฌูู ุงูุฏุฎูู

- ุนูุฏ ุชุณุฌูู ุงูุฏุฎููุ ุณูุชู ุงูุญุตูู ุนูู FCM token ุชููุงุฆูุงู
- ุฅุฐุง ูุดู ุงูุญุตูู ุนูู token ุฌุฏูุฏุ ุณูุชู ุงุณุชุฎุฏุงู token ูุญููุธ
- ุฅุฐุง ูู ููู ููุงู token ูุญููุธุ ุณูุชู ุชูููุฏ token ูุคูุช
- **ูู ูุชู ุฅุฑุณุงู "no_token_available" ุฃุจุฏุงู**

## ุงูุฃุณุจุงุจ ุงููุญุชููุฉ ูุนุฏู ุงูุญุตูู ุนูู FCM Token

### 1. ุนุฏู ูุฌูุฏ HTTPS (ูู ุงูุฅูุชุงุฌ ููุท)

```
โ ูุชุทูุจ HTTPS ููุญุตูู ุนูู FCM token ูู ุงูุฅูุชุงุฌ
```

**ุงูุญู**:

- ูู ุงูุชุทููุฑ: ุงูุชุทุจูู ูุนูู ุนูู HTTP ุจุฏูู ูุดุงูู
- ูู ุงูุฅูุชุงุฌ: ุชุฃูุฏ ูู ุชุดุบูู ุงูุชุทุจูู ุนูู HTTPS

### 2. ูุชุตูุญ Brave

```
โ ุฎุทุฃ ูู ุงูุญุตูู ุนูู FCM Token: AbortError: Registration failed - push service error
```

**ุงูุณุจุจ**: ูุชุตูุญ Brave ูุฏูู ุฅุนุฏุงุฏุงุช ุฎุตูุตูุฉ ุฃูุซุฑ ุตุฑุงูุฉ ููุฏ ูุญุธุฑ ุฎุฏูุงุช Firebase Push.

**ุงูุญู**:

- ูุชู ุชูููุฏ FCM token ูุคูุช ุชููุงุฆูุงู
- ุฑุณุงูุฉ ุชุญุฐูุฑ ุฎุงุตุฉ: "๐ฆ ูุชุตูุญ Brave - ูุฏ ูุง ูุฏุนู FCM ุจุดูู ูุงูู"

### 3. ุฑูุถ ุฅุฐู ุงูุฅุดุนุงุฑุงุช

```
โ ุชู ุฑูุถ ุฅุฐู ุงูุฅุดุนุงุฑุงุช
```

**ุงูุญู**: ุงุทูุจ ูู ุงููุณุชุฎุฏู ููุญ ุฅุฐู ุงูุฅุดุนุงุฑุงุช

### 4. ูุดููุฉ ูู Service Worker

```
โ ุฎุทุฃ ูู ุชุณุฌูู Service Worker
```

**ุงูุญู**: ุชุฃูุฏ ูู ูุฌูุฏ ููู `public/firebase-messaging-sw.js`

### 5. ุงููุชุตูุญ ูุง ูุฏุนู Firebase Messaging

```
โ ุงููุชุตูุญ ูุง ูุฏุนู Firebase Messaging
```

**ุงูุญู**: ุงุณุชุฎุฏู ูุชุตูุญ ุญุฏูุซ ูุฏุนู Service Workers

## ุงูุญููู ุงููุทุจูุฉ

### โ ุงูุญู ุงูุฃูู: ุงูุณูุงุญ ุจู HTTP ูู ุงูุชุทููุฑ

```javascript
// ูู ุจูุฆุฉ ุงูุชุทููุฑุ ูุณูุญ ุจู HTTP
if (
  typeof window !== "undefined" &&
  window.location.protocol !== "https:" &&
  process.env.NODE_ENV === "development"
) {
  console.warn("โ๏ธ ุชุญุฐูุฑ: FCM ูุนูู ุนูู HTTP ูู ุจูุฆุฉ ุงูุชุทููุฑ ููุท");
}
```

### โ ุงูุญู ุงูุซุงูู: ุชูููุฏ FCM Token ูุคูุช

```javascript
const generateTemporaryFCMToken = () => {
  const timestamp = Date.now();
  const randomString = Math.random().toString(36).substring(2, 15);
  const tempToken = `temp_fcm_${timestamp}_${randomString}`;
  return tempToken;
};
```

### โ ุงูุญู ุงูุซุงูุซ: ุงุณุชุฎุฏุงู Token ูุญููุธ

```javascript
const storedToken = localStorage.getItem("fcm_token");
if (storedToken) {
  fcmToken = storedToken;
  console.log("๐ ุงุณุชุฎุฏุงู FCM token ูุญููุธ ูู localStorage");
}
```

### โ ุงูุญู ุงูุฑุงุจุน: ูุดู ููุน ุงููุชุตูุญ

```javascript
const getBrowserInfo = () => {
  const userAgent = navigator.userAgent;
  if (userAgent.includes("Chrome") && !userAgent.includes("Brave")) {
    return "chrome";
  } else if (userAgent.includes("Brave")) {
    return "brave";
  } else if (userAgent.includes("Firefox")) {
    return "firefox";
  } else if (userAgent.includes("Safari")) {
    return "safari";
  } else {
    return "other";
  }
};
```

## Debugging

ุงูุชุญ Developer Tools (F12) ูุงูุชูู ุฅูู Console ูุฑุคูุฉ:

- ๐ ุจุฏุก ุชููุฆุฉ Firebase Messaging
- ๐ ุฏุนู ุงููุชุตูุญ
- ๐ ููุน ุงููุชุตูุญ: chrome/brave/firefox/safari
- โ๏ธ ุชุญุฐูุฑ: FCM ูุนูู ุนูู HTTP ูู ุจูุฆุฉ ุงูุชุทููุฑ ููุท
- ๐ง ุชุณุฌูู Service Worker
- ๐ ุทูุจ ุฅุฐู ุงูุฅุดุนุงุฑุงุช
- ๐ซ ุงูุญุตูู ุนูู FCM Token
- โ ุฃู โ ูุชูุฌุฉ ุงูุนูููุฉ
- ๐ฆ ูุชุตูุญ Brave - ุงุณุชุฎุฏุงู token ูุคูุช
- ๐ ุชูููุฏ FCM token ูุคูุช (ุฅุฐุง ูุดู ุงูุญุตูู ุนูู token ุญูููู)

## ููุงุญุธุงุช ูููุฉ

1. **HTTPS ูุทููุจ ูู ุงูุฅูุชุงุฌ ููุท**: FCM ูุนูู ุนูู HTTP ูู ุงูุชุทููุฑ
2. **ุฅุฐู ุงูุฅุดุนุงุฑุงุช**: ุงููุณุชุฎุฏู ูุฌุจ ุฃู ูููุญ ุฅุฐู ุงูุฅุดุนุงุฑุงุช
3. **Service Worker**: ูุฌุจ ุฃู ูููู ููุฌูุฏ ูู ูุฌูุฏ `public`
4. **Firebase Config**: ุชุฃูุฏ ูู ุตุญุฉ ุฅุนุฏุงุฏุงุช Firebase
5. **Token ูุคูุช**: ูู ุญุงูุฉ ูุดู ุงูุญุตูู ุนูู token ุญููููุ ุณูุชู ุชูููุฏ token ูุคูุช
6. **ูุชุตูุญ Brave**: ูุฏ ูุง ูุฏุนู FCM ุจุดูู ูุงูู ุจุณุจุจ ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ

## ุงูุชุญูู ูู ุงููุฌุงุญ

### ุนูุฏ ุงููุฌุงุญ ูุน FCM ุญูููู (Chrome):

```
โ ุชู ุงูุญุตูู ุนูู FCM Token ุจูุฌุงุญ
๐ฑ Token length: 142
๐ฑ FCM Token ุงูููุงุฆู: fxrQ7VYdwFANpU4JQzkzxh:APA91bHxWYoFiZOkF6X2ACPFk8_...
```

### ุนูุฏ ุงุณุชุฎุฏุงู Token ูุคูุช (Brave):

```
๐ฆ ูุชุตูุญ Brave - ุงุณุชุฎุฏุงู token ูุคูุช
๐ ุชูููุฏ FCM token ูุคูุช
๐ฑ FCM Token ุงูููุงุฆู: temp_fcm_1756726099886_kjh5q35cs1k
```

## ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ูู ูุชู ุฅุฑุณุงู "no_token_available" ุฃุจุฏุงู**  
โ **ุงูุชุทุจูู ูุนูู ุนูู HTTP ูู ุงูุชุทููุฑ**  
โ **ูุชู ุฅุฑุณุงู FCM token ุญูููู ุฃู ูุคูุช**  
โ **ุฏุนู ูุชุตูุญ Brave ูุน token ูุคูุช**  
โ **ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**  
โ **ุงูุฅุดุนุงุฑุงุช ุชุนูู ูุจุงุดุฑุฉ ุจุฏูู refresh**
