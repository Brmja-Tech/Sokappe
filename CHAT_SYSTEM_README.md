# نظام الشات - Sokappe

## نظرة عامة

تم إنشاء نظام شات ريال تايم متكامل باستخدام Firebase والـ API endpoints الموجودة. النظام يتضمن:

1. **أيقونة الشات في النافبار** - تعرض عدد الرسائل الجديدة
2. **قائمة منسدلة للشاتات** - تعرض آخر 5 شاتات
3. **صفحة الشاتات الرئيسية** - قائمة بجميع الشاتات
4. **صفحة الشات الفردية** - للمحادثة مع مستخدم معين
5. **زر "التحدث مع مقدم الخدمة"** - في صفحة تفاصيل الخدمة

## الملفات المُنشأة

### 1. ChatContext (`src/context/ChatContext.js`)

- إدارة حالة الشات والرسائل
- التواصل مع Firebase للريال تايم
- إدارة API calls للشات

### 2. Firebase Config (`src/config/firebase.js`)

- تكوين Firebase مع قاعدة البيانات
- تهيئة Realtime Database

### 3. ChatIcon (`src/component/ChatIcon/`)

- أيقونة الشات في النافبار
- قائمة منسدلة للشاتات السريعة
- عداد الرسائل الجديدة

### 4. Chats Page (`src/pages/Chats/`)

- صفحة الشاتات الرئيسية
- البحث في الشاتات
- قائمة بجميع الشاتات

### 5. Chat Page (`src/pages/Chat/`)

- صفحة الشات الفردية
- إرسال واستقبال الرسائل
- دعم الشات الجديد

## كيفية الاستخدام

### 1. إضافة زر الشات في صفحة تفاصيل الخدمة

تم إضافة زر "التحدث مع مقدم الخدمة" في صفحة تفاصيل الخدمة. الزر يظهر في قسم معلومات البائع.

### 2. الوصول للشاتات

- **من النافبار**: انقر على أيقونة الشات لفتح القائمة المنسدلة
- **من صفحة الشاتات**: انتقل إلى `/chats` لعرض جميع الشاتات
- **من صفحة تفاصيل الخدمة**: انقر على زر "التحدث مع مقدم الخدمة"

### 3. إنشاء شات جديد

- انقر على زر "التحدث مع مقدم الخدمة" في صفحة تفاصيل الخدمة
- سيتم توجيهك إلى صفحة شات جديدة
- اكتب رسالتك الأولى وارسلها
- سيتم إنشاء الشات تلقائياً

## الميزات

### ✅ ريال تايم

- الرسائل تظهر فوراً بدون ريفريش
- استخدام Firebase Realtime Database
- تحديث فوري لقائمة الشاتات

### ✅ تصميم احترافي

- واجهة مستخدم عصرية وجذابة
- دعم RTL للغة العربية
- دعم الوضع المظلم
- تصميم متجاوب للموبايل

### ✅ سهولة الاستخدام

- تنقل سلس بين الصفحات
- رسائل واضحة للمستخدم
- أزرار واضحة وسهلة الاستخدام

### ✅ دعم متعدد اللغات

- ترجمات عربية وإنجليزية
- تغيير اللغة تلقائي

## API Endpoints المستخدمة

### 1. إرسال رسالة

```
POST /chats/send
Body: { other_user_id: number, message: string }
```

### 2. جلب رسائل الشات

```
GET /chats/{chat_id}/messages
```

### 3. جلب شاتات المستخدم

```
GET /chats/user
```

## Firebase Structure

```
chats/
  {chat_id}/
    messages/
      {message_id}/
        id: number
        message: string
        read: boolean
        created_at: timestamp
        is_me: boolean
        timestamp: number
```

## التخصيص

### تغيير ألوان الأزرار

يمكنك تغيير ألوان الأزرار في ملفات CSS:

```css
.chatWithOwnerBtn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
```

### تغيير الرسائل

يمكنك تغيير الرسائل في ملفات الترجمة:

```json
{
  "chat": {
    "welcomeMessage": "مرحباً! كيف يمكنني مساعدتك؟",
    "startConversation": "ابدأ المحادثة الآن!"
  }
}
```

## استكشاف الأخطاء

### 1. لا تظهر الرسائل

- تأكد من أن Firebase config صحيح
- تحقق من اتصال الإنترنت
- تأكد من أن المستخدم مسجل دخول

### 2. لا يتم إرسال الرسائل

- تأكد من وجود token صحيح
- تحقق من API endpoint
- تأكد من صحة other_user_id

### 3. لا تظهر أيقونة الشات

- تأكد من أن المستخدم مسجل دخول
- تحقق من ChatProvider في App.js
- تأكد من import ChatIcon في Navbar

## الدعم

لأي استفسارات أو مشاكل، يرجى التواصل مع فريق التطوير.

---

**تم إنشاؤه بواسطة**: فريق Sokappe
**التاريخ**: 2025
**الإصدار**: 1.0.0
